Please look at code files SEARCH.rb for hash explanations.